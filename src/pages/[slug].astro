---
import Layout from "@layouts/Layout.astro";
import Tags from "@components/ui/Tags.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
---

<Layout title={`${project.data.title} | Project`}>
  <main class="mx-auto max-w-4xl px-5 py-10">
    <header class="mb-8">
      <div class="mb-2 flex flex-wrap items-center gap-3">
        <h1 class="font-monospace text-3xl text-orange md:text-5xl">{project.data.title}</h1>
        {
          project.data.inProgress && (
            <span class="rounded-full bg-orange px-3 py-1 text-xs font-semibold text-black" aria-label="project in progress">
              In progress
            </span>
          )
        }
      </div>
      <p class="text-black dark:text-white">{project.data.description}</p>
    </header>

    <section class="mb-10">
      <h2 class="mb-2 font-monospace text-2xl text-orange">What it is</h2>
      <p class="text-black dark:text-white">{project.data.what}</p>
    </section>

    <section class="mb-10">
      <h2 class="mb-2 font-monospace text-2xl text-orange">Features</h2>
      <ul class="list-disc space-y-2 pl-5 text-black dark:text-white">
        {project.data.features.map((feature) => <li>{feature}</li>)}
      </ul>
    </section>

    <section class="mb-10">
      <h2 class="mb-2 font-monospace text-2xl text-orange">Planned</h2>
      <ul class="list-disc space-y-2 pl-5 text-black dark:text-white">
        {project.data.planned.map((item) => <li>{item}</li>)}
      </ul>
    </section>

    <section class="mb-10">
      <h2 class="mb-2 font-monospace text-2xl text-orange">Technologies</h2>
      <ul class="list-disc space-y-2 pl-5 text-black dark:text-white">
        {project.data.technologies.map((tech) => <li>{tech}</li>)}
      </ul>
    </section>

    {
      project.data.screenshots && project.data.screenshots.length > 0 && (
        <section class="mb-10">
          <h2 class="mb-4 font-monospace text-2xl text-orange">Screenshots</h2>
          <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
            {project.data.screenshots.map((shot) => (
              <figure class="overflow-hidden rounded-xl bg-white shadow-lg">
                <img src={shot.src + "?raw=true"} alt={shot.alt} loading="lazy" class="h-auto w-full" />
                <figcaption class="p-3 text-sm text-black">{shot.label}</figcaption>
              </figure>
            ))}
          </div>
        </section>
      )
    }

    <footer>
      <div class="mt-3">
        <Tags tags={project.data.tags} />
      </div>
      <div class="mt-6 flex flex-wrap gap-3">
        <a href={project.data.github} target="_blank" rel="noopener" class="inline-flex items-center rounded bg-orange px-4 py-2 text-sm font-semibold text-black hover:opacity-90"> View repository </a>
        <a href="/" class="inline-flex items-center rounded border border-orange px-4 py-2 text-sm font-semibold text-black hover:bg-orange/10 dark:text-white"> Back </a>
      </div>
    </footer>
  </main>
</Layout>
